#项目部署文档
##1.环境搭建
- 安装jdk8，配置环境   
	1.下载jdk8压缩包并上传至Linux /opt/jdk目录下,解压并移动至/usr/local/jdk目录。在jdk/bin目录下   
	2.配置环境变量。cd到etc/目录下,vim .bash_profile文件。将 PATH=$PATH:$HOME/bin改JAVA_HOME=/usr/local/jkd      PATH=$PATH:$HOME/bin:$JAVA_HOME/bin，然后保存并退出   
	3.使用该指令source .bash_profile，然后环境变量生效   
	4.使用java --version指令测试java是否安装成功
- 安装mysql8   
	1.下载mysql压缩包并上传至Linux /opt/mysql目录下,解压并移动至/usr/local/mysql目录下。   
	2.在根目录下创建data文件夹。创建mysql组，再创建mysql用户并将mysql用户添加到组中。将mysql文件夹和data文件夹的所有者和所有组都改为mysql
	3.vim /etc/my.cnf文件   
	3.进入到/usr/local/mysql/bin目录下执行命令：./mysqld --user=mysql --basedir=/usr/local/mysql --datadir=/data/ --initialize 进行初始化。命令行会有输出信息，会生成初始密码，将该密码保存   
	4.进入/usr/local/mysql/目录，使用命令：cp -a ./support-files/mysql.server /etc/init.d/mysql 将mysql添加到系统。给该系统服务添加执行权限并添加chmod +x /etc/init.d/mysql，chkconfig --add mysql   
	5.启动并登录mysql,修改root密码，并刷新权限。   
	6.将本地mysql，guitar_community数据库导出,并上传到Linux。在Linux mysql中创建guitar_communtiy数据库并导入数据库文件。   
- 安装配置nginx   
	1.下载nginx压缩包并上传至Linux /opt/nginx目录下,解压并移动至/usr/local/nginx目录。   
	2.编译安装nginx。在/usr/local/nginx目录下执行以下指令：./configure;make && make install   
	3.配置nginx.conf文件，监听80和81端口。映射到本机的8080和8081端口
	4.进入/usr/local/nginx/sbin目录先执行./nignx启动
##2.项目开机自启
	1.使用maven将项目打jar包上传至linux springboot/目录下
	2.在/etc/rc.d/init.d路径下编写shell脚本projectstart.sh。项目自启动并且指定日志输出位置
 	nohup /usr/local/jdk/bin/java -jar /springboot/app.jar >/usr/local/jdk/data/applog.log 2>/usr/local/jdk/data/apperror.log &
	nohup /usr/local/jdk/bin/java -jar /springboot/consonle.jar >/usr/local/jdk/data/consolelog.log 2>/usr/local/jdk/data/consoleerror.log &
	3.vim /etc/rc.d/rc.local。在该文件下加人/bin/sh /etc/rc.d/init.d/projectstart.sh
	4.给该文件增加执行权限，重启linux，项目自动被拉起
##3.nginx开机自启
	1.在usr/lib/systemd/system/nginx.service目录下创建脚本文件。vi /usr/lib/systemd/system/nginx.service。脚本内容如下：
	[Unit]
	Description=nginx -  web server
	After=network.target remote-fs.target nss-lookup.target
	  
	[Service]
	Type=forking
	PIDFile=/usr/local/nginx/logs/nginx.pid
	ExecStartPre=/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf
	ExecStart=/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf
	ExecReload=/usr/local/nginx/sbin/nginx -s reload
	ExecStop=/usr/local/nginx/sbin/nginx -s stop
	ExecQuit=/usr/local/nginx/sbin/nginx -s quit
	PrivateTmp=true
	  
	[Install]
	WantedBy=multi-user.target
	2.配置完脚本后，重新加载一下系统服务： systemctl daemo-reload
	3.启动服务：systemctl start nginx.service，设置为开机自启：systemctl enable nginx.service
##4.docker安装配置
	1.安装yum工具   
	yum install -y yum-utils \
           device-mapper-persistent-data \
           lvm2 --skip-broken
	2.设置镜像仓库
	# 设置docker镜像源
	yum-config-manager \
    	--add-repo \
    	https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
	3.安装docker社区版
	yum install -y docker-ce
	4.使用docker version命令查看是否安装成功
	5.下载phpmyadmin镜像。创建并启动phpmyadmin容器
	docker pull phpmyadmin
	docker run --name myadmin -d -e PMA_ARBITRARY=1 -p 8888:80 phpmyadmin
	2.在宿主机中修改mysql的访问权限，让除本机外的其他ip也能访问mysql
	3.通过容器中的phpmyadmin查看管理数据库